---
import SEOHead from '../components/common/SEOHead.astro';
import Header  from '../components/common/Header.astro';
import Footer  from '../components/common/Footer.astro';
import { safeJsonLd } from '../lib/sanitize';

interface Props {
  title?: string;
  description?: string;
  ogImage?: string;
  ogType?: 'website' | 'article';
  noindex?: boolean;
  jsonLd?: Record<string, unknown>;
}

const { jsonLd, ...seoProps } = Astro.props;
---

<!doctype html>
<html lang="ja">
<head>
  <SEOHead {...seoProps} />
  {jsonLd && (
    <script type="application/ld+json" set:html={safeJsonLd(jsonLd)} />
  )}
  <style is:global>
    /* Fade-in animation for page sections */
    .fade-in {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    .fade-in.visible {
      opacity: 1;
      transform: translateY(0);
    }
    /* Smooth scroll */
    html { scroll-behavior: smooth; }
    /* Focus ring */
    :focus-visible {
      outline: 2px solid #2d5a3d;
      outline-offset: 3px;
    }
  </style>
</head>
<body class="bg-cream-50 text-charcoal-800 font-sans antialiased">
  <Header />
  <main class="pt-16 lg:pt-20">
    <slot />
  </main>
  <Footer />

  <script>
    // Intersection Observer for fade-in animations
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            observer.unobserve(entry.target);
          }
        });
      },
      { threshold: 0.1, rootMargin: '0px 0px -50px 0px' }
    );

    document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));
  </script>
</body>
</html>
